CMAKE_MINIMUM_REQUIRED(VERSION 3.1)

FIND_PACKAGE(OpenGL REQUIRED)
FIND_PACKAGE(GLUT REQUIRED)
FIND_PACKAGE(Threads REQUIRED)

FIND_PATH(GLM_INCLUDE_DIR glm/glm.hpp HINTS /usr/include /usr/local/include /opt/local/include)
FIND_PACKAGE(Qt5Widgets REQUIRED)
FIND_PACKAGE(Qt5Gui REQUIRED)
FIND_PACKAGE(Qt5OpenGL REQUIRED)

INCLUDE_DIRECTORIES(${Qt5Widgets_INCLUDES})
INCLUDE_DIRECTORIES(${GLM_INCLUDE_DIR} ${GLUT_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${CG2_SOURCE_DIR}/minqgl/include)
INCLUDE_DIRECTORIES(${CG2_SOURCE_DIR}/framework/include)

SET(CMAKE_INCLUDE_CURRENT_DIR ON)
SET(CMAKE_AUTOMOC ON)

# Compiler Settings
SET(CMAKE_CXX_STANDARD 14)
SET(GCC_COVERAGE_COMPILE_FLAGS "-Wall -O3")
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${GCC_COVERAGE_COMPILE_FLAGS}")

# Linking in our external framework library
LINK_DIRECTORIES(${CG2_SOURCE_DIR}/framework/src)

# Annoying hack since the files generated by moc are not automatically added to the executable
SET(app_SOURCES main.cpp QGLViewerWidget.cpp SidebarWidget.cpp surfaces.cpp ImplicitSurface.cpp)
SET(app_QT_HEADERS ${CG2_SOURCE_DIR}/minqgl/include/QGLViewerWidget.hpp ${CG2_SOURCE_DIR}/minqgl/include/SidebarWidget.hpp)
QT5_WRAP_CPP(app_HEADERS_MOC ${app_QT_HEADERS})

ADD_EXECUTABLE(cg2 ${app_SOURCES} ${app_HEADERS_MOC})
TARGET_LINK_LIBRARIES(cg2 framework ${OPENGL_LIBRARIES} ${$GLEW_LIBRARIES} ${GLUT_LIBRARIES} ${CMAKE_THREAD_LIBS_INIT} Qt5::OpenGL)
